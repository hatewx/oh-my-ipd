---
name: pdt-collaboration
description: |
  虚拟 PDT 团队协作技能。
  提供 PDT 团队成员间的协作协议、通信规范和工作流模板。
---

# PDT 团队协作技能

## 协作协议

### 1. 角色通信规范

#### Agent 间通信格式
```
[发送者] → [接收者]: [消息类型]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[消息内容]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
[期望响应]: [响应要求]
[截止时间]: [如果有]
```

#### 消息类型
- **REQUEST**: 请求执行某任务
- **REPORT**: 报告完成结果
- **BLOCK**: 报告阻塞问题
- **QUERY**: 查询信息
- **DECISION**: 决策通知

### 2. 协作工作流

#### 标准协作流程
```
1. LPDT 分配任务 → 指定角色
2. 角色接受任务 → 确认理解
3. 角色执行任务 → 定期报告进度
4. 任务完成 → 提交报告
5. LPDT 审核 → 确认或反馈
```

#### TR Dry Run 协作流程
```
1. Developer 提交 → 触发 TR
2. LPDT 协调 → 并行/串行分配评审任务
3. PQA/TMM/SE/PDU 评审 → 提交评审报告
4. LPDT 汇总 → 做出决策
5. 决策分发 → 相关角色执行
```

### 3. 冲突解决协议

#### 角色间冲突
当角色间出现分歧时：
1. **技术分歧** (如 SE vs Developer): 以 SE 决策为准
2. **需求分歧** (如 PDU vs Developer): 以 PDU 决策为准
3. **质量分歧** (如 PQA vs Developer): 以 PQA 门禁为准
4. **流程分歧**: 以 LPDT 决策为准

#### 升级路径
```
角色间协商 → 无法达成一致 → LPDT 裁决 → 仍无法解决 → 用户介入
```

### 4. 状态同步机制

#### 状态广播
关键状态变更时，LPDT 需要广播：
- 阶段变更
- TR 结果
- 重大决策
- 风险预警

#### 状态查询
任何角色可以查询其他角色的状态：
```
[查询者] → LPDT: QUERY 状态
LPDT → [目标角色]: QUERY 状态
[目标角色] → LPDT: REPORT 状态
LPDT → [查询者]: 转发状态
```

## 工作流模板

### 模板 1: 任务分配
```
════════════════════════════════════════════════════════════
任务分配: [任务ID]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
分配者: LPDT
执行者: [角色]
截止时间: [时间]
优先级: [P0/P1/P2]

任务描述:
[详细描述]

验收标准:
- [标准1]
- [标准2]

依赖:
- [依赖任务]

参考资源:
- [资源链接]
════════════════════════════════════════════════════════════
```

### 模板 2: 进度报告
```
════════════════════════════════════════════════════════════
进度报告: [任务ID]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
报告者: [角色]
报告时间: [时间]

进度: [%]
状态: [进行中/阻塞/完成]

已完成:
- [事项1]

进行中:
- [事项1]

阻塞:
- [阻塞原因]: [求助对象]

下一步:
- [计划]

需要帮助:
- [如果有]
════════════════════════════════════════════════════════════
```

### 模板 3: TR 评审请求
```
════════════════════════════════════════════════════════════
TR 评审请求: [TR-ID]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
提交者: Developer
提交时间: [时间]
迭代: [N]

提交内容:
- [变更摘要]

评审者:
- [x] PQA
- [x] TMM
- [x] SE
- [x] PDU

评审重点:
- PQA: [重点]
- TMM: [重点]
- SE: [重点]
- PDU: [重点]

截止时间: [时间]
════════════════════════════════════════════════════════════
```

### 模板 4: 决策通知
```
════════════════════════════════════════════════════════════
决策通知: [决策ID]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
决策者: [角色]
决策时间: [时间]
决策类型: [技术/需求/质量/流程/资源]

决策内容:
[详细决策]

决策理由:
[理由]

影响范围:
- [影响1]

执行要求:
- [要求1]

相关角色:
- [角色1]: [动作]
════════════════════════════════════════════════════════════
```

## 常用协作模式

### 模式 1: 并行评审
适用于 TR Dry Run，多个角色同时评审：
```
LPDT 触发 TR
├─ 并行触发 PQA 检查
├─ 并行触发 TMM 测试
├─ 并行触发 SE 评审
└─ 并行触发 PDU 验证

等待所有评审完成
→ LPDT 汇总并决策
```

### 模式 2: 串行流水线
适用于依赖明确的任务链：
```
PDU 完成 Charter
  ↓
SE 完成 LLD
  ↓
Developer 实现
  ↓
PQA/TMM/SE/PDU 评审
  ↓
LPDT 决策
```

### 模式 3: 敏捷迭代
适用于快速迭代场景：
```
Developer 快速实现 MVP
  ↓
PDU 快速验证
  ↓
如果通过 → 继续完善
如果失败 → 快速调整
```

## 质量门禁协作

### 门禁检查清单
各角色在 TR 中的门禁责任：

| 角色 | 门禁项 | 阻塞级别 |
|-----|-------|---------|
| PQA | Lint 错误 | BLOCKING |
| PQA | 安全漏洞 | BLOCKING |
| TMM | P0 测试失败 | BLOCKING |
| TMM | P1 测试失败 | WARNING |
| SE | 架构偏离 | BLOCKING |
| SE | 技术债务 | WARNING |
| PDU | P0 需求缺失 | BLOCKING |
| PDU | 需求偏离 | BLOCKING |

### 门禁升级
当门禁失败时：
1. **BLOCKING**: 立即停止，返回修复
2. **WARNING**: 记录问题，继续但需后续修复

## 资源协调

### Token 预算管理
LPDT 需要监控和协调 Token 使用：
```
预算分配:
- Developer: 50%
- SE: 20%
- PQA/TMM: 20%
- PDU/LPDT: 10%

预警阈值:
- 50%: 提醒
- 80%: 警告
- 100%: 停止或申请追加
```

### 时间协调
各角色的时间预期：
- PQA 检查: < 5 分钟
- TMM 测试: < 15 分钟
- SE 评审: < 30 分钟
- PDU 验证: < 20 分钟
- Developer 修复: 根据问题复杂度
